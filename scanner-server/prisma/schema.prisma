// scanner-server/prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ScannerProduct {
  id          String   @id @default(cuid())
  barcode     String   @unique
  name        String?
  brand       String?
  
  // Separate from main app categories
  category    ScannerCategory @relation(fields: [categoryId], references: [id])
  categoryId  String
  
  scans       ScannerProductScan[]
  createdAt   DateTime @default(now())
  
  @@map("scanner_products") // Avoid table name conflicts
}

model ScannerProductScan {
  id          String   @id @default(cuid())
  productId   String
  product     ScannerProduct @relation(fields: [productId], references: [id])
  
  // Core scanning data
  price       Float
  imageUrl    String
  qualityScore String
  shopName    String
  location    String
  
  // External reference to main app user (optional)
  externalUserId String? // Reference to main app's user ID
  
  // Geolocation
  latitude    Float?
  longitude   Float?
  
  createdAt   DateTime @default(now())
  
  @@map("scanner_product_scans")
}

model ScannerCategory {
  id          String   @id @default(cuid())
  name        String   @unique
  description String?
  products    ScannerProduct[]
  
  @@map("scanner_categories")
}